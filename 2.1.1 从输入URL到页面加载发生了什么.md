# 从输入URL到页面加载发生了什么

* segmentdefault: [从输入URL到页面加载发生了什么](https://segmentfault.com/a/1190000006879700)


```
总体来说分为以下几个过程:

DNS解析

TCP连接

发送HTTP请求

服务器处理请求并返回HTTP报文

浏览器解析渲染页面

连接结束
```


##  通常经过

1、首先，在浏览器地址栏中输入url

2、浏览器先查看浏览器缓存-系统缓存-路由器缓存，如果缓存中有，会直接在屏幕中显示页面内容。若没有，则跳到第三步操作。

3、在发送http请求前，需要域名解析(DNS解析)，解析获取相应的IP地址。

4、浏览器向服务器发起tcp连接，与浏览器建立tcp三次握手。

5、握手成功后，浏览器向服务器发送http请求，请求数据包。

6、服务器处理收到的请求，将数据返回至浏览器

7、浏览器收到HTTP响应

8、读取页面内容，浏览器渲染，解析html源码

9、生成Dom树、解析css样式、js交互

10、客户端和服务器交互

11、ajax查询

 

- 其中，步骤2的具体过程是：

  - 浏览器缓存：浏览器会记录DNS一段时间，因此，只是第一个地方解析DNS请求；
  - 操作系统缓存：如果在浏览器缓存中不包含这个记录，则会使系统调用操作系统，获取操作系统的记录(保存最近的DNS查询缓存)；
  - 路由器缓存：如果上述两个步骤均不能成功获取DNS记录，继续搜索路由器缓存；
  - ISP缓存：若上述均失败，继续向ISP搜索。

##  “三次握手”的过程是，
>发送端先发送一个带有SYN（synchronize）标志的数据包给接收端，在一定的延迟时间内等待接收的回复。  
接收端收到数据包后，传回一个带有SYN/ACK标志的数据包以示传达确认信息。  
接收方收到后再发送一个带有ACK标志的数据包给接收端以示握手成功。  
在这个过程中，如果发送端在规定延迟时间内没有收到回复则默认接收方没有收到请求，而再次发送，直到收到回复为止。
![](http://images0.cnblogs.com/blog/622045/201507/020946557039933.png)

- 第一次
  - 第一次握手：建立连接时，客户端发送syn包（syn=j）到服务器，并进入SYN_SENT状态，等待服务器确认；SYN：同步序列编号（Synchronize Sequence Numbers）。
- 第二次
  - 第二次握手：服务器收到syn包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态；
- 第三次
  - 第三次握手：客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=k+1），此包发送完毕，客户端和服务器进入ESTABLISHED（TCP连接成功）状态，完成三次握手。
完成三次握手，客户端与服务器开始传送数据，在上述过程中，还有一些重要的概念：


- SYN：同步序列编号（Synchronize Sequence Numbers）。
- ACK (Acknowledgement）即是确认字符


## 参考
- [从输入url到页面展示到底发生了什么](https://www.jianshu.com/p/23b388f8e5aa)
- [从输入URL到页面展示的详细过程](https://blog.csdn.net/wlk2064819994/article/details/79756669)
- [从输入URL到浏览器显示页面发生了什么](https://www.cnblogs.com/kongxy/p/4615226.html)
- [一个页面从输入URL到页面加载显示完成，这个过程都发生什么？](https://www.cnblogs.com/WaTa/p/5477374.html)
